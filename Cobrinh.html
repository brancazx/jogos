<!DOCTYPE html> <!-- Declara que este √© um documento HTML5 -->
<html lang="pt-BR"> <!-- Define o idioma da p√°gina como portugu√™s do Brasil -->
<head>
  <meta charset="UTF-8"> <!-- Define a codifica√ß√£o de caracteres como UTF-8 -->
  <title>Snake Game</title> <!-- T√≠tulo da p√°gina que aparece na aba do navegador -->
  <style>
    /* ===================== ESTILO DO BODY ===================== */
    body {
      margin: 0; /* Remove margens padr√£o do body */
      display: flex; /* Usa flexbox para posicionamento */
      justify-content: center; /* Centraliza horizontalmente */
      align-items: center; /* Centraliza verticalmente */
      height: 100vh; /* Altura da tela inteira */
      background: linear-gradient(135deg, #2c3e50, #3498db); /* Gradiente de fundo */
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; /* Fonte padr√£o */
    }

    /* ===================== ESTILO DO CANVAS ===================== */
    canvas {
      background: #ecf0f1; /* Cor de fundo do canvas */
      border: 8px solid #2c3e50; /* Borda em volta do canvas */
      border-radius: 12px; /* Bordas arredondadas */
      box-shadow: 0 8px 20px rgba(0,0,0,0.4); /* Sombra para efeito 3D */
    }

    /* ===================== OVERLAY (MENUS) ===================== */
    #overlay {
      position: absolute; /* Fixa em rela√ß√£o √† tela */
      top: 0; left: 0; /* Posi√ß√£o inicial no canto superior esquerdo */
      width: 100%; height: 100%; /* Ocupa toda a tela */
      display: flex; /* Flexbox para alinhamento */
      justify-content: center; /* Centraliza horizontalmente */
      align-items: center; /* Centraliza verticalmente */
      flex-direction: column; /* Organiza filhos em coluna */
      background: rgba(44,62,80,0.85); /* Fundo semi-transparente */
      color: #fff; /* Cor do texto branca */
      font-size: 24px; /* Tamanho da fonte */
    }

    /* ===================== BOT√ïES, SELECT, LABEL E INPUT ===================== */
    button, select, label, input {
      margin: 10px; /* Espa√ßamento entre elementos */
      padding: 12px 28px; /* Espa√ßo interno */
      font-size: 18px; /* Tamanho da fonte */
      font-weight: bold; /* Texto em negrito */
      border: none; /* Remove bordas padr√£o */
      border-radius: 8px; /* Bordas arredondadas */
      cursor: pointer; /* Cursor muda para m√£ozinha */
    }

    /* ===================== BOT√ÉO ===================== */
    button { 
      background: #27ae60; /* Cor de fundo do bot√£o */
      color: #fff; /* Cor do texto do bot√£o */
      transition: background 0.3s; /* Transi√ß√£o suave ao passar o mouse */
    }
    button:hover { background: #2ecc71; } /* Muda cor ao passar o mouse */

    /* ===================== SELECT ===================== */
    select { 
      background: #fff; /* Cor de fundo branca */
      color: #2c3e50; /* Cor do texto escura */
    }

    /* ===================== LABEL ===================== */
    label { 
      font-weight: normal; /* Texto normal */
      padding: 0; 
      margin: 6px; /* Pequeno espa√ßamento */
    }

    /* ===================== CHECKBOX ===================== */
    input[type="checkbox"]{ 
      width:18px; 
      height:18px; 
    }
  </style>
</head>
<body>
  <canvas id="gameCanvas" width="600" height="600"></canvas> <!-- Canvas onde o jogo ser√° desenhado -->
  <div id="overlay"></div> <!-- Div que vai mostrar menus e game over -->

  <script>
  // ==================== VARI√ÅVEIS GLOBAIS ====================
  const canvas = document.getElementById('gameCanvas'); // Pega refer√™ncia ao canvas
  const ctx = canvas.getContext('2d'); // Contexto 2D para desenhar
  const overlay = document.getElementById('overlay'); // Div de menus

  let snake, dir, food, score, lives; // Estado do jogo
  let cell = 20; // Tamanho de cada c√©lula da grid
  let gameSpeed = 100; // Velocidade padr√£o (m√©dio)
  let mapSize = 600; // Tamanho padr√£o do mapa
  let frameCount = 0; // Contador de frames para anima√ß√µes

  // ==================== SONS ====================
  const music = new Audio('Musica.mp3'); // M√∫sica de fundo
  music.loop = true; // Loop infinito
  music.preload = 'auto'; // Pr√©-carrega √°udio
  music.volume = 0.5; // Volume inicial

  const eatSound = new Audio('Maca.mp3'); // Som ao comer ma√ß√£
  eatSound.preload = 'auto';
  eatSound.volume = 0.9;

  const deathSound = new Audio('Morte.mp3'); // Som de morte
  deathSound.preload = 'auto';
  deathSound.volume = 0.9;

  let soundEnabled = true; // Flag para controlar som

  // Tenta tocar m√∫sica automaticamente
  function tryPlayMusic(){
    if(!soundEnabled) return; // Se som desativado, n√£o toca
    music.play().then(()=>{ 
      console.log('M√∫sica tocando'); // M√∫sica come√ßou com sucesso
    }).catch(err=>{
      console.warn('Reprodu√ß√£o autom√°tica bloqueada pelo navegador:', err);
      showEnableSoundButton(); // Mostra bot√£o para ativar som manualmente
    });
  }

  // Cria bot√£o para ativar som se autoplay for bloqueado
  function showEnableSoundButton(){
    const btnId = 'enable-sound-btn';
    if(document.getElementById(btnId)) return; // Evita criar duplicados
    const btn = document.createElement('button');
    btn.id = btnId;
    btn.textContent = 'Ativar Som';
    btn.style.position = 'absolute';
    btn.style.right = '16px';
    btn.style.top = '16px';
    btn.style.padding = '8px 12px';
    btn.style.fontSize = '14px';
    document.body.appendChild(btn);
    btn.addEventListener('click', ()=>{
      music.play().then(()=>{ btn.remove(); }).catch(e=>{
        console.error('Erro ao tentar tocar m√∫sica ap√≥s clique:', e);
      });
    });
  }

  // Fun√ß√£o para tocar efeitos sonoros
  function playSound(sound){
    if(!soundEnabled) return; // Se som desativado, n√£o toca
    try{ sound.currentTime = 0; }catch(e){} // Reinicia som
    sound.play().catch(err=>{
      console.warn('Erro ao reproduzir som:', err);
    });
  }

  // ==================== FUN√á√ïES DE MENU ====================
  function showOverlay(html){ overlay.innerHTML=html; overlay.style.display='flex'; } // Mostra overlay
  function hideOverlay(){ overlay.style.display='none'; } // Esconde overlay

  function mainMenu(){
    try{ music.pause(); music.currentTime = 0; }catch(e){} // Para m√∫sica
    showOverlay(`
      <h1>üêç Snake Game</h1>
      <button onclick="startSnake()">START</button>
      <button onclick="optionsMenu()">Op√ß√µes</button>
    `); // Mostra menu principal
  }

  function optionsMenu(){
    showOverlay(`
      <h2>‚öôÔ∏è Op√ß√µes</h2>
      <div style="display:flex;flex-direction:column;align-items:center;">
        <label for="difficulty">Dificuldade (velocidade)</label>
        <select id="difficulty">
          <option value="120">F√°cil</option>
          <option value="100" selected>M√©dio</option>
          <option value="60">Dif√≠cil</option>
        </select>
        <label for="mapSize">Tamanho do mapa</label>
        <select id="mapSize">
          <option value="400">Pequeno</option>
          <option value="600" selected>M√©dio</option>
          <option value="800">Grande</option>
        </select>
        <div style="margin-top:10px; display:flex; align-items:center; gap:8px;">
          <input type="checkbox" id="soundOn" checked />
          <label for="soundOn">Som ativado</label>
        </div>
        <div style="margin-top:12px;">
          <button onclick="applyOptions()">Salvar</button>
          <button onclick="mainMenu()">Voltar</button>
        </div>
      </div>
    `); // Mostra op√ß√µes do jogo
  }

  function applyOptions(){
    const diff = document.getElementById('difficulty').value; // Dificuldade
    const size = document.getElementById('mapSize').value; // Tamanho mapa
    const soundOnCheckbox = document.getElementById('soundOn'); // Checkbox som

    gameSpeed = parseInt(diff); // Aplica velocidade
    mapSize = parseInt(size); // Aplica tamanho
    soundEnabled = !!soundOnCheckbox.checked; // Aplica som

    canvas.width = mapSize; // Ajusta canvas
    canvas.height = mapSize;

    if(!soundEnabled){ try{ music.pause(); }catch(e){} } // Pausa m√∫sica se desativado
    mainMenu(); // Volta ao menu
  }

  // ==================== INICIA JOGO ====================
  function startSnake(){
    hideOverlay(); // Esconde menu

    // Inicializa cobra no centro
    const startX = Math.floor((canvas.width/2)/cell)*cell;
    const startY = Math.floor((canvas.height/2)/cell)*cell;
    snake = [ [startX, startY], [startX-cell, startY], [startX-2*cell, startY] ];
    dir = [1,0]; // Dire√ß√£o inicial (para direita)

    food = randomFood(); // Gera primeira comida
    score = 0; // Pontua√ß√£o inicial
    lives = 3; // Vidas iniciais
    frameCount = 0; // Zera contador de frames

    tryPlayMusic(); // Tenta tocar m√∫sica

    snakeLoop(); // Inicia loop principal do jogo
  }

  // ==================== GERAR COMIDA ====================
  function randomFood(){
    let fx, fy;
    do{
      fx = Math.floor(Math.random()*(canvas.width/cell))*cell; // Posi√ß√£o aleat√≥ria X
      fy = Math.floor(Math.random()*(canvas.height/cell))*cell; // Posi√ß√£o aleat√≥ria Y
    } while(snake.some(seg=>seg[0]===fx && seg[1]===fy)); // Evita gerar comida sobre a cobra
    return [fx, fy]; // Retorna posi√ß√£o
  }

  // ==================== LOOP PRINCIPAL ====================
  function snakeLoop(){
    ctx.clearRect(0,0,canvas.width,canvas.height); // Limpa tela
    frameCount++; // Incrementa contador de frames

    // ==================== DESENHAR GRID ====================
    ctx.strokeStyle = '#e1e5e9';
    for(let x=0;x<canvas.width;x+=cell){ ctx.beginPath(); ctx.moveTo(x,0); ctx.lineTo(x,canvas.height); ctx.stroke(); }
    for(let y=0;y<canvas.height;y+=cell){ ctx.beginPath(); ctx.moveTo(0,y); ctx.lineTo(canvas.width,y); ctx.stroke(); }

    // ==================== MOVIMENTA√á√ÉO DA COBRA ====================
    const head = [snake[0][0] + dir[0]*cell, snake[0][1] + dir[1]*cell]; // Nova posi√ß√£o da cabe√ßa
    const hitWall = head[0] < 0 || head[1] < 0 || head[0] >= canvas.width || head[1] >= canvas.height; // Colis√£o parede
    const hitSelf = snake.some(seg => seg[0] === head[0] && seg[1] === head[1]); // Colis√£o corpo
    if(hitWall || hitSelf){
      lives -= 1; // Perde vida
      if(lives <= 0){ playSound(deathSound); return gameOver(); } // Fim do jogo
      const startX = Math.floor((canvas.width/2)/cell)*cell;
      const startY = Math.floor((canvas.height/2)/cell)*cell;
      snake = [ [startX, startY], [startX-cell, startY], [startX-2*cell, startY] ]; // Reset cobra
      dir = [1,0]; 
      food = randomFood(); 
      setTimeout(snakeLoop, gameSpeed * 3); // Pausa antes de continuar
      return;
    }

    snake.unshift(head); // Adiciona nova cabe√ßa

    if(head[0] === food[0] && head[1] === food[1]){
      score += 10; // Incrementa pontua√ß√£o
      playSound(eatSound); // Toca som
      food = randomFood(); // Nova comida
    } else {
      snake.pop(); // Remove √∫ltimo segmento
    }

    // ==================== DESENHAR COMIDA ====================
    ctx.beginPath();
    ctx.fillStyle = '#e74c3c';
    ctx.arc(food[0] + cell/2, food[1] + cell/2, cell/2 - 2, 0, Math.PI*2);
    ctx.fill();
    ctx.strokeStyle = '#c0392b';
    ctx.stroke();

    ctx.beginPath(); // caule
    ctx.strokeStyle = '#6f4a2a';
    ctx.lineWidth = 2;
    ctx.moveTo(food[0] + cell/2, food[1] + 4);
    ctx.lineTo(food[0] + cell/2, food[1] - 6);
    ctx.stroke();

    ctx.beginPath(); // folha
    ctx.fillStyle = '#27ae60';
    ctx.ellipse(food[0] + cell/2 + 6, food[1] - 4, 5, 7, Math.PI/4, 0, 2*Math.PI);
    ctx.fill();

    // ==================== DESENHAR COBRA ====================
    snake.forEach((seg, i) => {
      const radius = (i === 0) ? cell/2 : cell/2 - 2; // Cabe√ßa maior
      const grad = ctx.createRadialGradient(seg[0]+cell/2, seg[1]+cell/2, 3, seg[0]+cell/2, seg[1]+cell/2, radius);
      grad.addColorStop(0, '#aef0c8'); grad.addColorStop(0.6, '#58d68d'); grad.addColorStop(1, '#117a43');
      ctx.fillStyle = grad;
      ctx.beginPath();
      ctx.arc(seg[0]+cell/2, seg[1]+cell/2, radius, 0, Math.PI*2);
      ctx.fill();
      if(i === 0){ drawHeadDetails(seg, dir); } // Desenha olhos e l√≠ngua da cabe√ßa
    });

    // ==================== HUD ====================
    ctx.fillStyle = '#2c3e50';
    ctx.font = '20px Arial';
    ctx.fillText(`Score: ${score}`, 20, 30);
    ctx.fillText(`Lives: ${lives}`, canvas.width - 110, 30);

    setTimeout(snakeLoop, gameSpeed); // Agenda pr√≥ximo frame
  }

  // ==================== DETALHES DA CABE√áA ====================
  function drawHeadDetails(seg, dir){
    const cx = seg[0] + cell/2;
    const cy = seg[1] + cell/2;
    let ox = 0, oy = 0;
    if(dir[0] === 1){ ox = 6; oy = 6; }
    if(dir[0] === -1){ ox = -6; oy = 6; }
    if(dir[1] === -1){ ox = 0; oy = -8; }
    if(dir[1] === 1){ ox = 0; oy = 10; }

    ctx.fillStyle = '#ffffff';
    ctx.beginPath(); ctx.arc(cx - 6 + ox, cy - 4 + oy, 3, 0, Math.PI*2); ctx.fill();
    ctx.beginPath(); ctx.arc(cx + 6 + ox, cy - 4 + oy, 3, 0, Math.PI*2); ctx.fill();

    ctx.fillStyle = '#000000';
    const pupilForward = 2;
    if(dir[0] === 1){ 
      ctx.beginPath(); ctx.arc(cx - 6 + ox + pupilForward, cy - 4 + oy, 1.5, 0, Math.PI*2); ctx.fill();
      ctx.beginPath(); ctx.arc(cx + 6 + ox + pupilForward, cy - 4 + oy, 1.5, 0, Math.PI*2); ctx.fill();
    } else if(dir[0] === -1){
      ctx.beginPath(); ctx.arc(cx - 6 + ox - pupilForward, cy - 4 + oy, 1.5, 0, Math.PI*2); ctx.fill();
      ctx.beginPath(); ctx.arc(cx + 6 + ox - pupilForward, cy - 4 + oy, 1.5, 0, Math.PI*2); ctx.fill();
    } else if(dir[1] === -1){
      ctx.beginPath(); ctx.arc(cx - 6 + ox, cy - 4 + oy - pupilForward, 1.5, 0, Math.PI*2); ctx.fill();
      ctx.beginPath(); ctx.arc(cx + 6 + ox, cy - 4 + oy - pupilForward, 1.5, 0, Math.PI*2); ctx.fill();
    } else {
      ctx.beginPath(); ctx.arc(cx - 6 + ox, cy - 4 + oy + pupilForward, 1.5, 0, Math.PI*2); ctx.fill();
      ctx.beginPath(); ctx.arc(cx + 6 + ox, cy - 4 + oy + pupilForward, 1.5, 0, Math.PI*2); ctx.fill();
    }

    if(frameCount % 15 < 6){ // Desenha l√≠ngua intermitente
      ctx.strokeStyle = '#c0392b'; ctx.lineWidth = 2;
      const tx = cx + dir[0] * (cell/2 + 2);
      const ty = cy + dir[1] * (cell/2 + 2);
      ctx.beginPath(); ctx.moveTo(cx, cy); ctx.lineTo(tx, ty); ctx.stroke();
      ctx.beginPath();
      if(dir[0] !== 0){
        ctx.moveTo(tx, ty); ctx.lineTo(tx + dir[0]*4, ty - 4);
        ctx.moveTo(tx, ty); ctx.lineTo(tx + dir[0]*4, ty + 4);
      } else {
        ctx.moveTo(tx, ty); ctx.lineTo(tx - 4, ty + dir[1]*4);
        ctx.moveTo(tx, ty); ctx.lineTo(tx + 4, ty + dir[1]*4);
      }
      ctx.stroke();
    }
  }

  // ==================== GAME OVER ====================
  function gameOver(){
    try{ music.pause(); }catch(e){}
    playSound(deathSound);
    showOverlay(`
      <h2>üíÄ Game Over</h2>
      <p>Pontua√ß√£o final: ${score}</p>
      <button onclick="mainMenu()">Voltar ao Menu</button>
    `);
  }

  // ==================== CONTROLES ====================
  document.addEventListener('keydown', e => {
    if(e.key === 'ArrowUp' && dir[1] === 0) dir = [0, -1];
    if(e.key === 'ArrowDown' && dir[1] === 0) dir = [0, 1];
    if(e.key === 'ArrowLeft' && dir[0] === 0) dir = [-1, 0];
    if(e.key === 'ArrowRight' && dir[0] === 0) dir = [1, 0];
  });

  mainMenu(); // Inicia mostrando o menu
  </script>
</body>
</html>
